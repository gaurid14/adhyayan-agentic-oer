<div id="a{{ answer.id }}"
     class="thread-row {% if level > 0 %}thread-child{% endif %}"
     style="--lvl:{{ level }}">

  <div class="answer-item {% if level > 0 %}answer-item--reply{% endif %}">
    <div class="answer-avatar" aria-hidden="true">
      {{ answer.author.username|slice:":1"|upper }}
    </div>

    <div class="answer-main">
      <div class="answer-meta">
        <span class="answer-author">{{ answer.author.username }}</span>
        <span class="dot">•</span>
        <span>{{ answer.created_at|date:"M d, Y H:i" }}</span>
        <span class="dot">•</span>
        <span>{{ answer.created_at|timesince }} ago</span>
      </div>

      <div class="answer-body prose">
        {{ answer.content|linebreaks }}
      </div>

      {% if user.is_authenticated %}
        <div class="answer-actions">

          <details class="reply-box" data-reply-box>
            <summary class="reply-toggle">
              </i> Reply
            </summary>

            <form method="post"
                  action="{% url 'forum_reply' question.id answer.id %}"
                  class="reply-form mt-2">
              {% csrf_token %}

              <textarea
                name="content"
                class="form-control reply-input"
                rows="2"
                placeholder="Write a reply… (Enter to send, Shift+Enter for new line)"
                data-enter-submit
                data-reply-input
              ></textarea>

              <div class="reply-actions">
                <button class="btn btn-sm btn-outline-secondary" type="submit">
                  Post reply
                </button>
              </div>
            </form>
          </details>
        </div>
      {% endif %}
    </div>

    {% if user.is_authenticated %}
      <form method="post" action="{% url 'forum_answer_upvote' answer.id %}" class="vote-form">
        {% csrf_token %}
        <button
          class="vote-btn"
          data-upvote-url="{% url 'forum_answer_upvote' answer.id %}"
          type="submit"
          title="Upvote"
        >
          <span class="vote-icon">▲</span>
          <span class="vote-count" data-upvote-key="a{{ answer.id }}" data-upvote-count>
            {{ answer.upvote_count }}
          </span>
        </button>
      </form>
    {% endif %}
  </div>
</div>
