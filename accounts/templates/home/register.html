{% extends "home/base.html" %} {% load static %} {% block title %}Login / Sign
Up{% endblock %} {% block content %}
<style>
  :root {
    --primary: #009688;
    --border: #e5e7eb;
    --text: #1f2937;
    --muted: #6b7280;
    --bg: #ffffff;
  }

  /* Page base */
  body {
    background: var(--bg);
    font-family:
      "Segoe UI",
      system-ui,
      -apple-system,
      BlinkMacSystemFont,
      sans-serif;
    color: var(--text);
  }

  /* Centering container */
  .container {
    min-height: calc(100vh - 120px);
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 48px 16px;
  }

  /* Auth card */
  .login-box {
    width: 100%;
    max-width: 760px;
    background: #ffffff;
    border-radius: 14px;
    border: 1px solid var(--border);
    padding: 48px 56px;
    box-shadow: 0 12px 32px rgba(0, 0, 0, 0.06);
  }

  /* Tabs */
  .tabs {
    display: flex;
    gap: 24px;
    border-bottom: 1px solid var(--border);
    margin-bottom: 40px;
  }

  .tab-link {
    font-weight: 600;
    color: var(--muted);
    padding-bottom: 10px;
    border-bottom: 3px solid transparent;
  }

  .tab-link.active {
    color: var(--primary);
    border-color: var(--primary);
  }

  /* Login / Signup visibility */
  .login-row,
  .signup-row {
    display: none;
  }

  .login-row.active {
    display: grid;
    grid-template-columns: 1fr 0.9fr;
    gap: 48px;
  }

  .signup-row.active {
    display: block;
  }

  /* Inputs â€“ NO FIXED HEIGHT */
  input,
  select,
  textarea {
    width: 100%;
    padding: 11px 14px;
    border-radius: 8px;
    border: 1px solid #d1d5db;
    font-size: 15px;
    background: #fff;
  }

  /* Textarea only */
  textarea {
    min-height: 110px;
    resize: vertical;
  }

  /* Focus */
  input:focus,
  select:focus,
  textarea:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px rgba(0, 150, 136, 0.12);
  }

  /* Buttons */
  .login-btn {
    margin-top: 36px;
    width: 100%;
    padding: 14px;
    border-radius: 10px;
    background: var(--primary);
    color: #fff;
    font-weight: 600;
    border: none;
    font-size: 16px;
  }

  .login-btn:hover {
    background: #00796b;
  }

  /* Role tabs */
  .role-tabs {
    display: flex;
    background: #f3f4f6;
    border-radius: 10px;
    padding: 6px;
    margin-bottom: 36px;
  }

  .role-tab {
    flex: 1;
    padding: 10px;
    background: transparent;
    border: none;
    font-weight: 600;
    border-radius: 8px;
    color: var(--muted);
    cursor: pointer;
  }

  .role-tab.active {
    background: #ffffff;
    color: var(--primary);
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
  }

  /* ===============================
       SIGNUP GRID â€“ REAL FIX
       =============================== */

  .role-form {
    display: none;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    column-gap: 32px;
    row-gap: 28px; /* ðŸ”‘ THIS FIXES CHIPKE HUE */
  }

  .role-form.active {
    display: grid;
  }

  /* Field wrapper */
  .form-group {
    display: flex;
    flex-direction: column;
  }

  /* Label spacing */
  .form-group label {
    font-size: 14px;
    font-weight: 500;
    margin-bottom: 8px;
  }

  /* Full width */
  .form-group.full-width {
    grid-column: 1 / -1;
  }

  /* Email + Password */
  .form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 32px;
    margin-top: 40px;
  }

  /* Illustration */
  .illustration {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .illustration img {
    max-width: 90%;
    opacity: 0.9;
  }

  /* Responsive */
  @media (max-width: 900px) {
    .login-row.active {
      grid-template-columns: 1fr;
    }

    .illustration {
      display: none;
    }

    .login-box {
      padding: 32px 24px;
    }

    .form-grid {
      grid-template-columns: 1fr;
    }
  }
</style>
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
  rel="stylesheet"
/>
<link
  href="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.css"
  rel="stylesheet"
  type="text/css"
/>

<div class="container">
  <div class="login-box">
    <div class="tabs">
      <a href="#" class="tab-link active" data-target="login">Login</a>
      <a href="#" class="tab-link" data-target="signup">Sign up</a>
    </div>

    <div class="form-row login-row active">
      <form class="login-form" method="POST" action="{% url 'login' %}">
        {% csrf_token %}
        <input type="email" name="email" placeholder="Email" required />
        <input
          type="password"
          name="password"
          placeholder="Password"
          required
        />
        <a href="#" class="forgot">Forgot your password?</a>
        <button type="submit" class="login-btn">Login</button> 
      </form>
      <div class="illustration">
        <img src="{% static 'accounts/animation.gif' %}" alt="Login GIF" />
      </div>
    </div>

    <div class="signup-row">
      <form class="signup-form" method="POST" action="{% url 'register' %}">
        {% csrf_token %}
        <input type="hidden" id="role-input" name="role" value="student" />

        <div class="role-tabs">
          <button type="button" class="role-tab" data-role="student">
            Student
          </button>
          <button type="button" class="role-tab" data-role="contributor">
            Contributor
          </button>
        </div>

        <div class="role-form-content">
          <div class="role-form active" id="student-form">
            <div class="form-group">
              <label>Full Name</label
              ><input type="text" name="student-name" required />
            </div>
            <div class="form-group">
              <label>College Name</label
              ><input type="text" name="college-name" required />
            </div>
            <div class="form-group">
              <label>Date of Birth</label
              ><input type="date" name="dob" required />
            </div>
            <div class="form-group">
              <label>Gender</label
              ><select name="gender" required>
                <option value="Male">Male</option>
                <option value="Female">Female</option>
                <option value="Other">Other</option>
              </select>
            </div>
            <div class="form-group">
              <label>Course</label>
              <select name="course" required>
                <option value="IT">IT</option>
                <option value="CS">CS</option>
                <option value="MECH">MECH</option>
                <option value="EXTC">EXTC</option>
              </select>
            </div>
            <div class="form-group">
              <label>Year</label>
              <select name="year" required>
                <option value="1">FE</option>
                <option value="2">SE</option>
                <option value="3">TE</option>
                <option value="4">BE</option>
              </select>
            </div>
          </div>

          <div class="role-form" id="contributor-form">
            <div class="form-group">
              <label>First Name</label
              ><input type="text" name="contrib-fname" required />
            </div>
            <div class="form-group">
              <label>Last Name</label
              ><input type="text" name="contrib-lname" required />
            </div>
            <div class="form-group">
              <label>Phone Number</label
              ><input type="tel" name="contrib-phone" required />
            </div>
            <div class="form-group">
              <label>Designation</label
              ><input type="text" name="designation" required />
            </div>
            <div class="form-group">
              <label>Years of Experience</label
              ><input type="number" name="exp" required />
            </div>
            <!-- Program Dropdown -->
            <!--                        <div class="form-group">-->
            <!--                            <label>Program</label>-->
            <!--                            <select name="program" id="program-select" required>-->
            <!--                                <option value="">Select Program</option>-->
            <!--                                <option value="Engineering">Engineering</option>-->
            <!--                                <option value="Commerce">Commerce</option>-->
            <!--                                <option value="Arts">Arts</option>-->
            <!--                                <option value="Science">Science</option>-->
            <!--                                <option value="Humanities">Humanities</option>-->
            <!--                            </select>-->
            <!--                        </div>-->

            <!-- Highest Qualification Dropdown -->
            <div class="form-group">
              <label>Highest Qualification</label>
              <select name="qualification" id="qualification-select" required>
                <option value="">Select Highest Qualification</option>
                <option value="Bachelor">Bachelor</option>
                <option value="Masters">Masters</option>
                <option value="PhD">PhD</option>
                <option value="Others">Others</option>
              </select>
            </div>

            <!-- Expertise checkboxes will be populated here -->
            <!--                        <div class="form-group">-->
            <!--                            <label>Domain of Expertise</label>-->
            <!--                            <div id="expertise-checkboxes">-->
            <!--                                &lt;!&ndash; Dynamically filled based on selected program &ndash;&gt;-->
            <!--                            </div>-->
            <!--                        </div>-->
            <div class="form-group full-width">
              <label for="domain-input-tagify"
                >Key Skills / Expertise involved</label
              >
              <input
                type="text"
                id="domain-input-tagify"
                name="domain"
                placeholder="Add skills..."
                required
              />
              <!-- <small>Please press enter while specifying multiple skills.</small> -->
            </div>
            <div class="form-group">
              <label>Date of Birth</label
              ><input type="date" name="contrib-dob" required />
            </div>
            <div class="form-group">
              <label>Current Institution</label
              ><input type="text" name="institution" required />
            </div>
            <div class="form-group full-width">
              <label>Short Bio</label><textarea name="bio"></textarea>
            </div>
          </div>
        </div>

        <div class="form-grid">
          <div class="form-group">
            <label>Email</label>
            <input type="email" name="email" required />
          </div>
          <div class="form-group">
            <label>Create Password</label>
            <input type="password" name="password" required />
          </div>
        </div>

        <button type="submit" class="login-btn">Sign Up</button> 
      </form>
    </div>
    <div><br></div> 
    {% if messages %}
    <div class="mb-3">
      {% for message in messages %}
        <div class="alert
            {% if message.tags == 'error' %}alert-danger
            {% elif message.tags == 'success' %}alert-success
            {% elif message.tags == 'warning' %}alert-warning
            {% else %}alert-info{% endif %}
            alert-dismissible fade show"
            role="alert"
            style="border-radius: 12px;">
          <strong>
            {% if message.tags == 'error' %}Action needed:{% else %}Info:{% endif %}
          </strong>
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    </div>
  {% endif %}

  <div class="form-row login-row active">  
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/@yaireo/tagify"></script>
<script src="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.polyfills.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    // ---- Tab switching code (unchanged) ----
    const mainTabs = document.querySelectorAll(".tab-link");
    const loginRow = document.querySelector(".login-row");
    const signupRow = document.querySelector(".signup-row");
    mainTabs.forEach((tab) => {
      tab.addEventListener("click", (e) => {
        e.preventDefault();
        mainTabs.forEach((t) => t.classList.remove("active"));
        tab.classList.add("active");
        loginRow.classList.toggle("active", tab.dataset.target === "login");
        signupRow.classList.toggle("active", tab.dataset.target === "signup");
      });
    });

    const roleTabsContainer = document.querySelector(".role-tabs");
    const roleForms = document.querySelectorAll(".role-form");
    const roleTabs = document.querySelectorAll(".role-tab");
    const roleInput = document.getElementById("role-input");

    function updateFormRequirements(activeRole) {
      <!--            roleForms.forEach(form => {-->
      <!--                const isVisible = form.id === activeRole + '-form';-->
      <!--                form.querySelectorAll('input, select, textarea').forEach(input => {-->
      <!--                    if (input.type !== 'file') input.required = isVisible;-->
      <!--                });-->
      <!--            });-->
      roleForms.forEach((form) => {
        const isVisible = form.id === activeRole + "-form";
        form
          .querySelectorAll("input:not([type=hidden]), select, textarea")
          .forEach((input) => {
            // Check if the element exists and is not Tagify's internal input
            if (input && !input.hasAttribute("contenteditable")) {
              input.required = isVisible;
            }
          });
      });
    }

    if (roleTabsContainer) {
      roleTabsContainer.addEventListener("click", (e) => {
        if (!e.target.matches(".role-tab")) return;
        const targetRole = e.target.dataset.role;
        if (roleInput) roleInput.value = targetRole;
        roleTabs.forEach((tab) => tab.classList.remove("active"));
        e.target.classList.add("active");
        roleForms.forEach((form) =>
          form.classList.toggle("active", form.id === targetRole + "-form"),
        );
        updateFormRequirements(targetRole);
      });
    }

    // Keep student form active by default
    const studentForm = document.getElementById("student-form");
    const studentTab = document.querySelector('.role-tab[data-role="student"]');
    if (studentForm && studentTab) {
      studentForm.classList.add("active");
      studentTab.classList.add("active");
    }
    updateFormRequirements("student");

    <!--        // &#45;&#45;&#45;&#45; Contributor Program -> Expertise logic &#45;&#45;&#45;&#45;-->
    <!--        const programSelect = document.getElementById('program-select');-->
    <!--        const expertiseContainer = document.getElementById('expertise-checkboxes');-->

    <!--        if (programSelect) {-->
    <!--            programSelect.addEventListener('change', async () => {-->
    <!--                expertiseContainer.innerHTML = '';-->
    <!--                const program = programSelect.value;-->
    <!--                if (!program) return;-->

    <!--                try {-->
    <!--                    const response = await fetch(`/register/?program=${program}`);-->
    <!--                    const data = await response.json();-->

    <!--                    data.forEach(exp => {-->
    <!--                        const div = document.createElement('div');-->
    <!--                        div.classList.add('checkbox-item');-->
    <!--                        div.innerHTML = `-->
    <!--                            <input type="checkbox" id="exp-${exp.id}" name="expertise" value="${exp.id}">-->
    <!--                            <label for="exp-${exp.id}">${exp.name}</label>-->
    <!--                        `;-->
    <!--                        expertiseContainer.appendChild(div);-->
    <!--                    });-->
    <!--                } catch (error) {-->
    <!--                    console.error("Failed to load expertise:", error);-->
    <!--                }-->
    <!--            });-->
    <!--        }-->
    // ---- SIMPLE Tagify Initialization ----
    var domainInput = document.getElementById("domain-input-tagify");
    if (domainInput) {
      // Initialize Tagify with no whitelist or restrictions
      var tagify = new Tagify(domainInput, {
        maxTags: 10, // optional limit
        enforceWhitelist: false, // allow free text input
        dropdown: {
          enabled: 0, // no dropdown suggestions
        },
      });

      // Ensure form validation works properly
      tagify.on("change", function (e) {
        domainInput.required = e.detail.value.length === 0;
      });
    }
  });
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

{% endblock %}
