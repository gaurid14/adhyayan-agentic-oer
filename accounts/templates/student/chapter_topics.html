{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>{{ course.course_name }} | {{ chapter.chapter_name }}</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <style>

        body{
            margin:0;
            font-family:Inter,sans-serif;
            background:#f4f7fb;
        }

        /* ===== HEADER ===== */

        .learning-header{
            background:linear-gradient(135deg,#0f5f56,#157a6e);
            color:white;
            padding:28px 6%;
        }

        .learning-header h1{
            margin:0;
            font-size:26px;
            font-weight:800;
        }

        .learning-header p{
            margin-top:6px;
            opacity:.9;
        }

        /* ===== LAYOUT ===== */

        .container{
            width:92%;
            max-width:1400px;
            margin:25px auto;
        }

        .layout{
            display:grid;
            grid-template-columns:360px 1fr;
            gap:24px;
        }

        @media(max-width:1000px){
        .layout{grid-template-columns:1fr;}
        }

        /* ===== SIDEBAR ===== */

        .sidebar{
            background:white;
            border-radius:18px;
            padding:20px;
            box-shadow:0 8px 24px rgba(0,0,0,.06);
            position:sticky;
            top:20px;
            height:fit-content;
        }

        .sidebar h2{
            margin:0 0 15px;
            font-size:17px;
        }

        /* dropdown */

        select{
            width:100%;
            padding:10px;
            border-radius:10px;
            border:1px solid #ddd;
            margin-bottom:18px;
        }

        /* topics */

        .topic-item{
            display:flex;
            justify-content:space-between;
            align-items:center;
            padding:12px;
            border-radius:12px;
            text-decoration:none;
            color:#222;
            font-weight:600;
            transition:.25s;
        }

        .topic-item:hover{
            background:#eef7f6;
        }

        .topic-active{
            background:#dff4f1;
            color:#0f5f56;
        }

        /* ===== CONTENT AREA ===== */

        .content{
            background:white;
            border-radius:18px;
            padding:24px;
            box-shadow:0 8px 24px rgba(0,0,0,.06);
        }

        /* topic title */

        .topic-title{
            font-size:22px;
            font-weight:800;
        }

        .topic-meta{
            color:#666;
            margin-top:4px;
        }

        /* divider */

        .divider{
            height:1px;
            background:#eee;
            margin:18px 0;
        }

        /* PLAYER */

        .player{
            border-radius:14px;
            overflow:hidden;
            border:1px solid #ddd;
            margin-top:12px;
        }

        iframe{
            width:100%;
            border:none;
        }

        /* empty */

        .empty{
            background:#f7fafc;
            padding:30px;
            border-radius:14px;
            text-align:center;
            color:#666;
        }

        .badge{
            background:#e6f6f4;
            color:#0f5f56;
            padding:5px 10px;
            border-radius:999px;
            font-size:12px;
            font-weight:700;
        }

        /* ===== TOP NAV ===== */

        .top-nav{
            display:flex;
            align-items:center;
            justify-content:space-between;
            margin-bottom:15px;
        }

        .back-btn{
            text-decoration:none;
            background:white;
            color:#0f5f56;
            padding:8px 14px;
            border-radius:10px;
            font-weight:600;
            border:1px solid rgba(0,0,0,0.08);
            box-shadow:0 3px 8px rgba(0,0,0,.05);
            transition:.25s;
        }

        .back-btn:hover{
            background:#eaf6f4;
        }

    </style>
</head>

<body>

<!-- HEADER -->
<div class="learning-header">

    <div class="top-nav">

        <!-- BACK BUTTON -->
        <a href="{% url 'student_dashboard' %}" class="back-btn">
            ‚Üê Back to Dashboard
        </a>

        <span style="opacity:.85;font-weight:600;">
            Student Learning Mode
        </span>

    </div>

    <h1>{{ course.course_name }} ‚Ä¢ {{ chapter.chapter_name }}</h1>
    <p>{{ course.course_code }} ‚Ä¢ Semester {{ course.semester }}</p>
</div>

<div class="container">

    <div class="layout">

        <!-- ================= SIDEBAR ================= -->
        <div class="sidebar">

            <h2>üìò Syllabus Explorer</h2>

            <select onchange="location=this.value;">
                {% for ch in chapters %}
                <option value="?course_id={{course.id}}&chapter_id={{ch.id}}"
                        {% if ch.id == chapter.id %}selected{% endif %}>
                    Chapter {{ch.chapter_number}}: {{ch.chapter_name}}
                </option>
                {% endfor %}
            </select>

            {% for topic in topics %}
            <a class="topic-item {% if selected_topic == topic %}topic-active{% endif %}"
               href="?course_id={{course.id}}&chapter_id={{chapter.id}}&topic={{topic|urlencode}}">
                <span>{{topic}}</span>
                <span>‚Üí</span>
            </a>
            {% endfor %}

        </div>

        <!-- ================= CONTENT ================= -->
        <div class="content">

            {% if selected_topic %}

            <div class="topic-title">{{selected_topic}}</div>

            <div class="topic-meta">
                Course: <b>{{course.course_name}}</b>
                &nbsp;‚Ä¢&nbsp;
                Chapter {{chapter.chapter_number}}
            </div>

            <div class="divider"></div>

            <!-- VIDEO -->
            <h3>üé• Video Lecture</h3>

            {% if video_id %}
            <div class="player">
                <iframe height="480"
                        src="https://drive.google.com/file/d/{{video_id}}/preview"
                        allow="autoplay">
                </iframe>
            </div>
            {% else %}
            <div class="empty">No video available</div>
            {% endif %}

            <div class="divider"></div>

            <!-- PDF -->
            <h3>üìÑ Study Material</h3>

            {% if pdf_id %}
            <div class="player">
                <iframe height="600"
                        src="https://drive.google.com/file/d/{{pdf_id}}/preview">
                </iframe>
            </div>
            {% else %}
            <div class="empty">No PDF notes uploaded</div>
            {% endif %}

            {% else %}

            <div class="empty">
                <h3>Select a topic üëà</h3>
                <p>Video lecture and study material will appear here.</p>
            </div>

            {% endif %}

        </div>

    </div>
</div>

</body>
</html>